(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["group-foo"],{"76ca":function(e,t,a){"use strict";a("a906")},"8c43":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"config-main"},[a("div",{staticClass:"main-top"},[a("el-card",{staticClass:"box-card",attrs:{"body-style":{color:"#eee"}}},[a("div",{class:"card-header "+(e.mqttIsConnected?"is-connected":""),attrs:{slot:"header"},slot:"header"},[a("span",[e._v("MQTT服务器")])]),a("div",{staticClass:"card-item"},[a("div",{staticClass:"card-item-left"},[a("ul",[a("li",[e._v(" 复位云控制连接："),a("el-button",{attrs:{type:"primary",size:"mini",loading:e.loading.cloudControl},on:{click:e.handleResetCloudControl}},[a("i",{staticClass:"iconfont icon-fuwei1"})])],1),a("li",[e._v(" 需同步的数据： "),a("el-select",{staticClass:"sync-select",attrs:{multiple:"",placeholder:"请选择同步的数据"},model:{value:e.syncData,callback:function(t){e.syncData=t},expression:"syncData"}},e._l(e.syncGroup,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.data,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)})),1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.handleChangeSyncData}},[e._v("保存")])],1)])]),a("div",{staticClass:"card-item-right"})])]),a("el-card",{staticClass:"box-card"},[a("div",{class:"card-header "+(e.controlIsConnected?"is-connected":""),attrs:{slot:"header"},slot:"header"},[a("span",[e._v("云控制服务器")])]),a("div",{staticClass:"card-item"},[a("div",{staticClass:"card-item-left"},[a("ul",[a("li",[e._v(" Bootloader操作："),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.handleEntryBootloader}},[e._v("进入引导程序")]),a("el-button",{attrs:{type:"primary",size:"mini",loading:e.loading.entryApp},on:{click:e.handleQuitBootloader}},[e._v("退出并进入应用程序")])],1),a("li",[e._v(" 在线固件升级："),a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"http://49.234.11.185/updatefirmware/","auto-upload":!1,multiple:!1,"show-file-list":!0,limit:1,"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError,"file-list":e.fileList,"http-request":e.uploadFile}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取固件")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success",loading:e.loading.upload},on:{click:e.submitUpload}},[e._v(e._s(e.loading.upload?"更新中...":"更新到设备"))])],1)],1)])]),a("div",{staticClass:"card-item-right"})])])],1),a("div",{staticClass:"main-bottom"},[a("el-card",{staticClass:"box-card",attrs:{"body-style":{color:"#eee"}}},[a("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("默认配置")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.handleChangeDefaultConfig}},[e._v("保存")])],1),a("div",{staticClass:"config-body"},[a("div",{staticClass:"camera-left"},[a("ul",[a("li",[a("i",{staticClass:"iconfont icon-14"}),e._v("对比度："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_contrast,callback:function(t){e.$set(e.carState,"camera_contrast",t)},expression:"carState.camera_contrast"}},e._l(e.selectList,(function(t){return a("el-option",{key:t,attrs:{label:t+"级",value:t}},[e._v(e._s(t)+" 级 ")])})),1)],1),a("li",[a("i",{staticClass:"iconfont icon-saturation"}),e._v("饱和度："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_saturation,callback:function(t){e.$set(e.carState,"camera_saturation",t)},expression:"carState.camera_saturation"}},e._l(e.selectList,(function(t){return a("el-option",{key:t,attrs:{label:t+"级",value:t}},[e._v(e._s(t)+" 级 ")])})),1)],1),a("li",[a("i",{staticClass:"iconfont icon-heibaipingheng"}),e._v("白平衡："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_light_mode,callback:function(t){e.$set(e.carState,"camera_light_mode",t)},expression:"carState.camera_light_mode"}},e._l(e.selectList,(function(t){return a("el-option",{key:t,attrs:{label:t+"级",value:t}},[e._v(e._s(t)+" 级 ")])})),1)],1),a("li",[a("i",{staticClass:"iconfont icon-football_name"}),e._v("模式："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_mode,callback:function(t){e.$set(e.carState,"camera_mode",t)},expression:"carState.camera_mode"}},[a("el-option",{attrs:{label:"连续",value:0}})],1)],1),a("li",[a("i",{staticClass:"iconfont icon-geshi_tupianjpg"}),e._v("格式："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_workmode,callback:function(t){e.$set(e.carState,"camera_workmode",t)},expression:"carState.camera_workmode"}},[a("el-option",{attrs:{label:"JPG",value:1}})],1)],1)])]),a("div",{staticClass:"camera-right"},[a("ul",[a("li",[a("i",{staticClass:"iconfont icon-brightj2"}),e._v("亮度："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_brightness,callback:function(t){e.$set(e.carState,"camera_brightness",t)},expression:"carState.camera_brightness"}},e._l(e.selectList,(function(t){return a("el-option",{key:t,attrs:{label:t+"级",value:t}},[e._v(e._s(t)+" 级 ")])})),1)],1),a("li",[a("i",{staticClass:"iconfont icon-texiao"}),e._v("特效："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_effect,callback:function(t){e.$set(e.carState,"camera_effect",t)},expression:"carState.camera_effect"}},e._l(e.camera_effectList,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),a("li",[a("i",{staticClass:"iconfont icon-puguang"}),e._v("曝光："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_autoexposure_level,callback:function(t){e.$set(e.carState,"camera_autoexposure_level",t)},expression:"carState.camera_autoexposure_level"}},e._l(e.selectList,(function(t){return a("el-option",{key:t,attrs:{label:t+"级",value:t}},[e._v(e._s(t)+" 级 ")])})),1)],1),a("li",[a("i",{staticClass:"iconfont icon-tiaoxingma"}),e._v("彩条："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_color_bar,callback:function(t){e.$set(e.carState,"camera_color_bar",t)},expression:"carState.camera_color_bar"}},[a("el-option",{attrs:{label:"关闭",value:0}}),a("el-option",{attrs:{label:"开启",value:1}})],1)],1),a("li",[a("i",{staticClass:"iconfont icon-quanping_huaban1"}),e._v("尺寸："),a("el-select",{class:"select-item ",attrs:{placeholder:"请选择","popper-class":"option-list"},model:{value:e.carState.camera_size,callback:function(t){e.$set(e.carState,"camera_size",t)},expression:"carState.camera_size"}},e._l(e.camera_size,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1)])]),a("div",{staticClass:"duoji-setting"},[a("ul",[a("li",[a("i",{staticClass:"iconfont icon-duoji1"}),e._v("一维舵机角度： "),a("el-slider",{staticClass:"duoji",attrs:{min:-135,max:135,step:5,"show-tooltip":""},model:{value:e.carState.cur_duoji_1_angle,callback:function(t){e.$set(e.carState,"cur_duoji_1_angle",t)},expression:"carState.cur_duoji_1_angle"}})],1),a("li",[a("i",{staticClass:"iconfont icon-chuangyipingtai_duoji"}),e._v("二维舵机角度： "),a("el-slider",{staticClass:"duoji",attrs:{min:-45,max:135,step:5,"show-tooltip":""},model:{value:e.carState.cur_duoji_2_angle,callback:function(t){e.$set(e.carState,"cur_duoji_2_angle",t)},expression:"carState.cur_duoji_2_angle"}})],1),a("li",[a("i",{staticClass:"iconfont icon-xuanzhuan"}),e._v("设置旋转速度： "),a("el-slider",{staticClass:"duoji",attrs:{min:0,max:200,step:1,"show-tooltip":""},model:{value:e.carState.set_dir_speed_whole,callback:function(t){e.$set(e.carState,"set_dir_speed_whole",t)},expression:"carState.set_dir_speed_whole"}})],1),a("li",[a("i",{staticClass:"iconfont icon-shipin2"}),e._v("默认开启视频： "),a("el-switch",{staticClass:"img-open",attrs:{"inactive-value":1,"active-value":0},model:{value:e.carState.camera_is_abort,callback:function(t){e.$set(e.carState,"camera_is_abort",t)},expression:"carState.camera_is_abort"}})],1)])])])]),a("el-card",{staticClass:"box-card-mini"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("设备管理")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.handleAddDevice}},[e._v("添加设备")])],1),a("div",{staticClass:"device-manage"},[a("div",{staticClass:"device-manage-left"},[e._v(" 已有设备： "),a("el-card",{staticClass:"device-manage-card"},[a("ul",e._l(e.deviceList,(function(t,s){return a("li",{key:s},[a("div",{staticClass:"car-name",on:{click:function(t){return e.handleShowDevice(s)}}},[e._v(" "+e._s(t.name)+" ")]),a("el-button",{staticStyle:{flex:"1",padding:"3px 0"},attrs:{type:"text"},on:{click:function(a){return e.handleDeleteDevice(t.secret,s)}}},[e._v("删除")])],1)})),0)])],1),a("div",{staticClass:"device-manage-right"},[e._v(" 设备详情： "),a("el-button",{staticStyle:{float:"right",padding:"5px"},attrs:{size:"mini",type:"text"},on:{click:function(t){return e.handleSaveDevice("edit")}}},[e._v("保存设备")]),a("el-card",{staticClass:"device-manage-card"},[a("div",[a("ul",[a("li",[e._v(" 设备名："),a("el-input",{staticClass:"car-manage-input",attrs:{size:"mini",placeholder:"请输入设备名"},model:{value:e.curDevice.name,callback:function(t){e.$set(e.curDevice,"name",t)},expression:"curDevice.name"}})],1),a("li",[e._v(" 设备密钥："),a("el-input",{staticClass:"car-manage-input",attrs:{size:"mini",placeholder:"请输入设备密钥"},model:{value:e.curDevice.secret,callback:function(t){e.$set(e.curDevice,"secret",t)},expression:"curDevice.secret"}})],1)])])])],1)])])],1)])},c=[],r=a("1da1"),i=(a("ac1f"),a("1276"),a("b0c0"),a("a434"),a("96cf"),{data:function(){return{camera_effectList:["正常","负片","黑白","偏红色","偏绿色","偏蓝色","复古"],camera_size:["160*120","176*144","320*240","400*240","352*288","640*480","800*600","1024*768","1280*800","1280*960","1440*900","1280*1024","1600*1200"],selectList:[0,1,2,3,4],mqttIsConnected:!1,controlIsConnected:!1,carState:{camera_is_abort:1,cur_duoji_1_angle:0,cur_duoji_2_angle:0,set_dir_speed_whole:20,camera_mode:0,camera_workmode:1,camera_contrast:2,camera_saturation:4,camera_effect:0,camera_autoexposure_level:0,camera_light_mode:4,camera_brightness:3,camera_color_bar:0,camera_size:5},fileList:[],loading:{entryApp:!1,upload:!1,cloudControl:!1},syncData:["cur_speed_whole","cur_speed_lq","cur_speed_rq","cur_speed_lh","cur_speed_rh","cur_duoji_1_angle","cur_duoji_2_angle","camera_mode","camera_workmode","camera_contrast","camera_saturation","camera_effect","camera_autoexposure_level","camera_light_mode","camera_brightness","camera_color_bar","camera_size","camera_frame","camera_is_abort","history_speed","history_frame"],syncGroup:[{label:"车速数据",data:[{value:"cur_speed_whole",label:"整体车速"},{value:"cur_speed_lq",label:"左前轮车速"},{value:"cur_speed_rq",label:"右前轮车速"},{value:"cur_speed_lh",label:"左后轮车速"},{value:"cur_speed_rh",label:"右后轮车速"}]},{label:"舵机数据",data:[{value:"cur_duoji_1_angle",label:"一维舵机角度"},{value:"cur_duoji_2_angle",label:"二维舵机角度"}]},{label:"摄像头数据",data:[{value:"camera_mode",label:"模式"},{value:"camera_workmode",label:"格式"},{value:"camera_contrast",label:"对比度"},{value:"camera_saturation",label:"饱和度"},{value:"camera_effect",label:"特效"},{value:"camera_autoexposure_level",label:"曝光"},{value:"camera_light_mode",label:"白平衡"},{value:"camera_brightness",label:"亮度"},{value:"camera_color_bar",label:"彩条"},{value:"camera_size",label:"尺寸"},{value:"camera_frame",label:"帧率"},{value:"camera_is_abort",label:"视频状态"}]},{label:"历史数据",data:[{value:"history_speed",label:"小车车速"},{value:"history_frame",label:"视频帧率"}]}],deviceList:[],curDevice:{name:"",secret:""}}},mounted:function(){var e=this;this.getSyncData(),this.getDefaultConfig(),this.getDeviceList(),setInterval((function(){var t=sessionStorage.getItem("iotc_state");t&&(t=JSON.parse(t),!e.mqttIsConnected&&t.mqttIsConnected&&(e.loading.upload=!1,e.loading.entryApp=!1),e.mqttIsConnected=t.mqttIsConnected,e.controlIsConnected=t.controlIsConnected)}),1e3)},methods:{showMessage:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(e){case 0:a&&this.$message.success(t);break;case-1:break;default:a&&this.$message.warning(t);break}},commonRequest:function(e){var t=arguments,a=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var c,r,i,n,l,o,u;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return c=t.length>1&&void 0!==t[1]&&t[1],r=t.length>2&&void 0!==t[2]?t[2]:{},i=t.length>3&&void 0!==t[3]?t[3]:"post",n=localStorage.getItem("iotc_user")||"",l=localStorage.getItem("iotc_secret")||"",o={user:n,secret:l},s.prev=6,s.next=9,a.$http[i](e,Object.assign(o,r));case 9:u=s.sent,s.next=14;break;case 12:s.prev=12,s.t0=s["catch"](6);case 14:return a.showMessage(u.data.state,u.data.message,c),s.abrupt("return",u);case 16:case"end":return s.stop()}}),s,null,[[6,12]])})))()},uploadFile:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s,c,i,n,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=new FormData,c=localStorage.getItem("iotc_user")||"",i=localStorage.getItem("iotc_secret")||"",n={headers:{"Content-Type":"multipart/form-data"}},s.append("file",e.file),s.append("user",c),s.append("secret",i),!t.mqttIsConnected){a.next=13;break}return a.next=10,t.commonRequest("/command/r-2",!1,{data:"1"});case 10:setTimeout(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.commonRequest("/command/r-3",!1,{data:"1"});case 2:return e.prev=2,e.next=5,t.$http.post("/upload/firmware",s,n);case 5:e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),t.$message.warning("上传失败");case 11:case"end":return e.stop()}}),e,null,[[2,8]])}))),18e3),a.next=24;break;case 13:return a.next=15,t.commonRequest("/command/r-3",!1,{data:"1"});case 15:return a.prev=15,a.next=18,t.$http.post("/upload/firmware",s,n);case 18:l=a.sent,a.next=24;break;case 21:a.prev=21,a.t0=a["catch"](15),t.$message.warning("上传失败");case 24:t.showMessage(l.data.state,l.data.message,!0);case 25:case"end":return a.stop()}}),a,null,[[15,21]])})))()},getSyncData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.commonRequest("/get/sync");case 2:a=t.sent,a.data.data&&(e.syncData=a.data.data.split(",")||[]);case 4:case"end":return t.stop()}}),t)})))()},getDefaultConfig:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.commonRequest("/get/default");case 2:a=t.sent,a.data.data&&Object.assign(e.carState,JSON.parse(a.data.data)||{});case 4:case"end":return t.stop()}}),t)})))()},deviceManage:function(e,t,a){var s=this;return Object(r["a"])(regeneratorRuntime.mark((function c(){var r;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return c.next=2,s.commonRequest("/manage/".concat(e),!0,{secret:t,name:a});case 2:r=c.sent,r.data.data&&(s.deviceList=JSON.parse(r.data.data)||[]);case 4:case"end":return c.stop()}}),c)})))()},getDeviceList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.commonRequest("/public/deviceList");case 2:a=t.sent,a.data.data&&(e.deviceList=JSON.parse(a.data.data)||[]);case 4:case"end":return t.stop()}}),t)})))()},handleShowDevice:function(e){this.curDevice.name=this.deviceList[e].name,this.curDevice.secret=this.deviceList[e].secret},handleSaveDevice:function(e){var t=this.curDevice;t.secret&&t.name?this.deviceManage(e,t.secret,t.name):this.$message.warning("字段不符合,请重新填写")},handleAddDevice:function(){this.deviceList.push({name:"",secret:""})},handleDeleteDevice:function(e,t){e&&this.deviceManage("delete",e),this.deviceList.splice(t,1)},handleChangeDefaultConfig:function(){this.commonRequest("/modify/default",!0,{data:this.carState})},handleChangeSyncData:function(){this.commonRequest("/modify/sync",!0,{data:this.syncData})},handleEntryBootloader:function(){var e=this;if(!this.controlIsConnected)return this.$message.warning("云控制服务器未连接,无法执行指令");this.commonRequest("/command/r-2",!0,{data:"1"}),setTimeout((function(){e.commonRequest("/command/c-0",!0,{data:"1"})}),18e3),setTimeout((function(){e.$message.warning("请等待重新连接云控制服务器")}),5e3)},handleQuitBootloader:function(){return this.controlIsConnected?this.mqttIsConnected?this.$message.warning("请先进入Bootloader模式"):(this.loading.entryApp=!0,void this.commonRequest("/command/a-1",!0,{data:"0"})):this.$message.warning("云控制服务器未连接,无法执行指令")},handleResetCloudControl:function(){if(!this.mqttIsConnected)return this.$message.warning("MQTT服务器未连接,无法执行指令");sessionStorage.setItem("reset_wifi2","1")},submitUpload:function(){if(!this.controlIsConnected)return this.$message.warning("云控制服务器未连接,无法更新");this.loading.upload=!0,this.$refs.upload.submit()},handleUploadSuccess:function(){this.fileList=[]},handleUploadError:function(){}}}),n=i,l=(a("76ca"),a("2877")),o=Object(l["a"])(n,s,c,!1,null,"408a9ca0",null);t["default"]=o.exports},a906:function(e,t,a){}}]);